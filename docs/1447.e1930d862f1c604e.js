"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[1447],{1447:(b,u,s)=>{s.r(u),s.d(u,{default:()=>l});var e=s(4438),c=s(7765);let f=(()=>{class r extends c.u{constructor(){super(...arguments),this.basePath="whiteboard-db",this.endpoint=""}static{this.\u0275fac=(()=>{let t;return function(a){return(t||(t=e.xGo(r)))(a||r)}})()}static{this.\u0275prov=e.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var h=s(9417);const p=["canvas"];let l=(()=>{class r{constructor(){this.drawing=!1,this.lastPoint=null,this.whiteboardService=(0,e.WQX)(f),this.sessionId="room-1",this.color="#000000",this.lineWidth=2,this.points=[]}ngOnInit(){const t=this.canvasRef.nativeElement;t.width=t.offsetWidth,t.height=600,this.ctx=t.getContext("2d"),this.initEvents(),this.whiteboardService.getById(this.sessionId).subscribe(n=>{this.points=n?.data??[],this.redrawFromPoints(this.points)})}initEvents(){const t=this.canvasRef.nativeElement;t.addEventListener("mousedown",n=>this.startDraw(n)),t.addEventListener("mousemove",n=>this.draw(n)),t.addEventListener("mouseup",()=>this.endDraw()),t.addEventListener("mouseleave",()=>this.endDraw())}startDraw(t){this.drawing=!0;const n=this.getCoordinates(t);this.lastPoint=n}draw(t){if(!this.drawing)return;const n=this.getCoordinates(t);this.drawOnCanvas(n,!0)}endDraw(){this.drawing=!1,this.lastPoint=null}getCoordinates(t){const a=this.canvasRef.nativeElement.getBoundingClientRect();return{x:t.clientX-a.left,y:t.clientY-a.top}}drawOnCanvas(t,n){this.ctx&&(this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap="round",this.ctx.strokeStyle=this.color,this.lastPoint&&(this.ctx.beginPath(),this.ctx.moveTo(this.lastPoint.x,this.lastPoint.y),this.ctx.lineTo(t.x,t.y),this.ctx.stroke()),this.lastPoint={x:t.x,y:t.y},n&&(this.points.push({...this.lastPoint,color:this.color,width:this.lineWidth}),this.whiteboardService.update(this.sessionId,{data:this.points})))}redrawFromPoints(t){const n=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,n.width,n.height),this.lastPoint=null,t.forEach(a=>{this.color=a.color,this.lineWidth=a.width,this.drawOnCanvas(a,!1)})}clearCanvas(){this.points=[],this.ctx.clearRect(0,0,this.canvasRef.nativeElement.width,this.canvasRef.nativeElement.height),this.whiteboardService.update(this.sessionId,{data:[]})}static{this.\u0275fac=function(n){return new(n||r)}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-whiteboard"]],viewQuery:function(n,a){if(1&n&&e.GBs(p,7),2&n){let o;e.mGM(o=e.lsd())&&(a.canvasRef=o.first)}},decls:7,vars:2,consts:[["canvas",""],[1,"toolbar"],["type","color",3,"ngModelChange","ngModel"],["type","range","min","1","max","10",3,"ngModelChange","ngModel"],[3,"click"],["width","800","height","600",2,"border","1px solid #ccc"]],template:function(n,a){if(1&n){const o=e.RV6();e.j41(0,"div",1)(1,"input",2),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(a.color,d)||(a.color=d),e.Njj(d)}),e.k0s(),e.j41(2,"input",3),e.mxI("ngModelChange",function(d){return e.eBV(o),e.DH7(a.lineWidth,d)||(a.lineWidth=d),e.Njj(d)}),e.k0s(),e.j41(3,"button",4),e.bIt("click",function(){return e.eBV(o),e.Njj(a.clearCanvas())}),e.EFF(4,"\u{1f9f9} Clear"),e.k0s()(),e.nrm(5,"canvas",5,0)}2&n&&(e.R7$(),e.R50("ngModel",a.color),e.R7$(),e.R50("ngModel",a.lineWidth))},dependencies:[h.YN,h.me,h.MR,h.BC,h.vS],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:20px;background:#f5f7fa;height:100vh;box-sizing:border-box;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.toolbar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;margin-bottom:16px;background:#fff;padding:10px 20px;border-radius:8px;box-shadow:0 2px 6px #0000001a}.toolbar[_ngcontent-%COMP%]   input[type=color][_ngcontent-%COMP%]{width:40px;height:40px;border:none;background:none;padding:0;cursor:pointer}.toolbar[_ngcontent-%COMP%]   input[type=range][_ngcontent-%COMP%]{width:120px}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#ff5252;border:none;color:#fff;font-weight:700;border-radius:6px;cursor:pointer;transition:background-color .3s ease}.toolbar[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#e53935}canvas[_ngcontent-%COMP%]{width:100%;max-width:1000px;height:auto;border:2px solid #cfd8dc;background-color:#fff;box-shadow:0 0 10px #0000000d;border-radius:8px}"]})}}return r})()},7765:(b,u,s)=>{s.d(u,{u:()=>p});var e=s(467),c=s(4438),f=s(9972),h=s(1469);let p=(()=>{class l{constructor(){this.db=(0,c.WQX)(f.h),this.storageService=(0,c.WQX)(h._)}get fullPath(){return`${this.basePath}/${this.endpoint}`}generatePath(i=""){return i?`${this.fullPath}/${i}`:this.fullPath}create(i,t){return this.db.create(this.generatePath(t),i)}get$(){return this.db.readRealtime$(this.fullPath)}getById(i){return this.db.readRealtimeOriginal$(`${this.fullPath}/${i}`)}update(i,t){return this.db.update(`${this.fullPath}/${i}`,t)}remove(i){return this.db.remove(`${this.fullPath}/${i}`)}set(i,t){return this.db.set(this.generatePath(i),t)}getKeys$(i=""){return this.db.getKeys$(this.generatePath(i))}getKeys(i=""){return this.db.getKeys(this.generatePath(i))}readOnce(i=""){return this.db.readOnce(this.generatePath(i))}read$(i=""){return this.db.readRealtime$(this.generatePath(i))}clearDb(){return this.set("",null)}updateCounter(i,t=!0){return this.db.updateCounterV2(this.generatePath(i),t)}createWithFile(i,t,n){var a=this;return(0,e.A)(function*(){if(!t)throw new Error("Please select an image.");const o=yield a.storageService.uploadFile(a.basePath,t,n),g={...i,imageUrl:o};yield a.create(g)})()}uploadFile(i,t){var n=this;return(0,e.A)(function*(){if(!i)throw new Error("Please select an image.");return yield n.storageService.uploadFile(n.basePath,i,t)})()}extractAndUploadFiles(i,t){var n=this;return(0,e.A)(function*(){return n.storageService.extractAndUploadFiles(i,n.basePath,t)})()}static{this.\u0275fac=function(t){return new(t||l)}}static{this.\u0275prov=c.jDH({token:l,factory:l.\u0275fac,providedIn:"root"})}}return l})()}}]);