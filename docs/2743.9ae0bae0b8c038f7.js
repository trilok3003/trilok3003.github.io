"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[2743],{2743:(M,v,h)=>{h.d(v,{A:()=>B});var p=h(467),d=h(4438),b=h(4668),P=h(7673),f=h(4572),S=h(8810),C=h(9437),D=h(8141),u=h(6354);function y(s){return new Date(s).toISOString().split("T")[0]}var w=h(9972);let A=(()=>{class s{constructor(){this.methodCallCount={}}trackMethodCall(t){this.methodCallCount[t]||(this.methodCallCount[t]=0),this.methodCallCount[t]++,console.log(`${t} called ${this.methodCallCount[t]} times`)}getMethodCallCount(t){return this.methodCallCount[t]||0}static{this.\u0275fac=function(e){return new(e||s)}}static{this.\u0275prov=d.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();var $=function(s){return s.CATEGORY="categories_wise",s.STATUS="status_wise",s.DATE="date_wise",s}($||{});function m(s,i,t,e,a,r,n,o){const l=t.toLowerCase().trim();return function k(s,i,t="asc"){return[...s].sort((e,a)=>{const r=e[i],n=a[i],o=r<n?-1:r>n?1:0;return"asc"===t?o:-o})}(s,a,r).filter(c=>{const g=!i||c.categoryId===i,I=c.title?.toLowerCase().includes(l)||c.body?.toLowerCase().includes(l);return g&&I&&("All"===e||c.status===e)&&(!n||c.sprintId===n)&&(null===o||c.bookmark===o)})}let B=(()=>{class s{constructor(t,e){this.firebaseRealtimeDatabaseService=t,this.trackingService=e,this.basePath="topics-db",this.postEndpoint="posts",this.categoryEndpoint="categories",this.sprintEndpoint="sprints",this.checklistEndpoint="checklist",this.legacySpacesPath="spaces-db",this.newBasePath="topics-db",this.totalPosts=(0,d.vPA)(0),this.posts$=this.fetchPosts().pipe((0,b.t)(1)),this.categories$=this.fetchCategories().pipe((0,b.t)(1)),this.safePosts$=this.posts$.pipe((0,C.W)(a=>(this.handleError(a),(0,P.of)([])))),this.postsWithCategory$=(0,f.z)([this.posts$,this.categories$]).pipe((0,D.M)(([a])=>this.totalPosts.set(a.length)),(0,u.T)(([a,r])=>this.attachCategoryNames(a,r))),this.groupedCategories$=(0,f.z)([this.categories$,this.posts$]).pipe((0,u.T)(([a,r])=>a.reduce((n,o)=>{const l=r.filter(g=>g.categoryId===o.key);return(l.length?n.withPosts:n.withoutPosts).push({...o,posts:l}),n},{withPosts:[],withoutPosts:[]})))}fetchPosts(){return this.firebaseRealtimeDatabaseService.readRealtime$(`${this.basePath}/${this.postEndpoint}`)}fetchCategories(){return this.firebaseRealtimeDatabaseService.readRealtime$(`${this.basePath}/${this.categoryEndpoint}`)}attachCategoryNames(t,e){return t.map(a=>({...a,categoryName:e.find(r=>r.key===a.categoryId)?.title||"Uncategorized"}))}createPost(t){return this.firebaseRealtimeDatabaseService.create(`${this.basePath}/${this.postEndpoint}`,t)}updatePost(t,e){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.postEndpoint}/${t}`,e)}removePost(t){return this.firebaseRealtimeDatabaseService.remove(`${this.basePath}/${this.postEndpoint}/${t}`)}removeMultiplePosts(t){var e=this;return(0,p.A)(function*(){const a=t.map(r=>e.removePost(r));yield Promise.all(a)})()}getPost(t){return this.firebaseRealtimeDatabaseService.readRealtimeOriginal$(`${this.basePath}/${this.postEndpoint}/${t}`)}getCategoriesWisePosts(){return this.postsWithCategory$.pipe((0,u.T)(t=>this.manageData($.CATEGORY,t)))}createCategory(t){return this.firebaseRealtimeDatabaseService.create(`${this.basePath}/${this.categoryEndpoint}`,t)}removeCategory(t){return this.firebaseRealtimeDatabaseService.remove(`${this.basePath}/${this.categoryEndpoint}/${t}`)}getCategories(){return this.categories$}getCategory(t){return this.firebaseRealtimeDatabaseService.readRealtimeOriginal$(`${this.basePath}/${this.categoryEndpoint}/${t}`)}getCategoryById(t){return this.firebaseRealtimeDatabaseService.readRealtimeOriginal$(`${this.basePath}/${this.categoryEndpoint}/${t}`)}getPostsByCategoryId(t){return this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{categoryId:t})}getPostsByCategoryWithName(t){return(0,f.z)([this.getPostsByCategoryId(t),this.categories$]).pipe((0,u.T)(([e,a])=>e.map(r=>({...r,categoryName:a.find(n=>n.key===r.categoryId)?.title??"Uncategorized"}))))}filterPostsByCategory(t,e="",a="All",r="createdAt",n="desc"){return this.getPostsByCategoryWithName(t).pipe((0,u.T)(o=>m(o,"",e,a,r,n)))}getPostsByStatus(t){return"All"===t?this.postsWithCategory$:this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{status:t})}getPostsBySprintId(t){return this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{sprintId:t})}getPostsServerSide(t,e,a){return t?this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{categoryId:t}):e?this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{sprintId:e}):a&&"All"!==a?this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.postEndpoint}`,{status:a}):this.posts$}filterPosts1(t,e,a="All",r="createdAt",n="desc",o="",l=null){return this.postsWithCategory$.pipe((0,u.T)(c=>m(c,t,e,a,r,n,o,l)))}filterPosts(t,e,a="All",r="createdAt",n="desc",o="",l=null){const c=this.getPostsServerSide(t||void 0,o||void 0,a);return this.withCategoryNames(c).pipe((0,u.T)(g=>m(g,t,e,a,r,n,o,l)))}matchesSearch(t,e){const a=t.title?.toLowerCase().includes(e),r=t.body?.toLowerCase().includes(e);return!(!a&&!r)}handleError(t){return console.error("Error occurred:",t),(0,S.$)(()=>new Error("Unknown error occurred. Please try again later."))}manageData(t,e){let a,r;switch(t){case $.CATEGORY:a=n=>n.categoryId,r=n=>n.categoryName;break;case $.STATUS:a=n=>n.status,r=n=>n.status;break;case $.DATE:a=n=>y(n.updatedAt),r=n=>y(n.updatedAt);break;default:return[]}return function R(s,i,t){const e={};for(const a of s){const r=i(a),n=t(a);e[r]||(e[r]={key:r,title:n,data:[]}),e[r].data.push(a)}return Object.values(e)}(e,a,r)}createSprint(t){return this.firebaseRealtimeDatabaseService.create(`${this.basePath}/${this.sprintEndpoint}`,t)}getSprints(){return this.firebaseRealtimeDatabaseService.readRealtime$(`${this.basePath}/${this.sprintEndpoint}`)}getSprint(t){return this.firebaseRealtimeDatabaseService.readRealtimeOriginal$(`${this.basePath}/${this.sprintEndpoint}/${t}`)}updateSprint(t,e){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.sprintEndpoint}/${t}`,e)}withCategoryNames(t){return(0,f.z)([t,this.categories$]).pipe((0,u.T)(([e,a])=>e.map(r=>({...r,categoryName:a.find(n=>n.key===r.categoryId)?.title??"Uncategorized"}))))}moveLists(t,e,a=!1){return(0,p.A)(function*(){})()}createChecklist(t){return this.firebaseRealtimeDatabaseService.create(`${this.basePath}/${this.checklistEndpoint}`,t)}updateChecklist(t,e){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.checklistEndpoint}/${t}`,e)}getChecklist(){return this.firebaseRealtimeDatabaseService.readRealtime$(`${this.basePath}/${this.checklistEndpoint}`)}getChecklistByCategoryId(t){return this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.checklistEndpoint}`,{categoryId:t})}getChecklistByCategoryOrSpace(t,e){if(!t&&!e)throw new Error("categoryId or spaceId is required");return this.firebaseRealtimeDatabaseService.readRealtimeWhere$(`${this.basePath}/${this.checklistEndpoint}`,t?{categoryId:t}:{spaceId:e})}getChecklistById(t){return this.firebaseRealtimeDatabaseService.readRealtimeOriginal$(`${this.basePath}/${this.checklistEndpoint}/${t}`)}getChecklistItemsById(t){return this.firebaseRealtimeDatabaseService.readRealtime$(`${this.basePath}/${this.checklistEndpoint}/${t}/items`)}updateTitle(t,e){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.checklistEndpoint}/${t}`,{title:e})}addItem(t,e,a=!1){return this.firebaseRealtimeDatabaseService.create(`${this.basePath}/${this.checklistEndpoint}/${t}/items`,{name:e,completed:a})}toggleItem(t,e,a){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.checklistEndpoint}/${t}/items/${e}`,{completed:a})}renameItem(t,e,a){return this.firebaseRealtimeDatabaseService.update(`${this.basePath}/${this.checklistEndpoint}/${t}/items/${e}`,{name:a})}removeItem(t,e){return this.firebaseRealtimeDatabaseService.remove(`${this.basePath}/${this.checklistEndpoint}/${t}/items/${e}`)}createCheckListWithOrginalKey(t,e){var a=this;return(0,p.A)(function*(){yield a.firebaseRealtimeDatabaseService.set(`${a.basePath}/${a.checklistEndpoint}/${t}`,e)})()}addItemWithKey(t,e,a){return this.firebaseRealtimeDatabaseService.set(`${this.basePath}/${this.checklistEndpoint}/${t}/items/${e}`,{name:a.name,completed:a.completed})}checkIfExists(t){return this.firebaseRealtimeDatabaseService.readOnceOriginal(`${this.basePath}/${this.checklistEndpoint}/${t}`)}static{this.\u0275fac=function(e){return new(e||s)(d.KVO(w.h),d.KVO(A))}}static{this.\u0275prov=d.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()}}]);