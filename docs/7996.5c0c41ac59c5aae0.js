"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[7996],{7996:(J,f,c)=>{c.r(f),c.d(f,{EmployeesModule:()=>q});var p=c(6895),u=c(4793),e=c(4650);const y=function(){return["./employeesPage"]};let g=(()=>{class s{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees"]],decls:8,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light","mb-3"],[1,"navbar-brand","mb-0","h1"],[1,"navbar-nav","mr-auto"],["routerLinkActive","active",1,"nav-item",3,"routerLink"],[1,"nav-link"]],template:function(o,n){1&o&&(e.TgZ(0,"nav",0)(1,"span",1),e._uU(2,"Angular + Firebase + State Management"),e.qZA(),e.TgZ(3,"ul",2)(4,"li",3)(5,"a",4),e._uU(6,"Employees"),e.qZA()()()(),e._UZ(7,"router-outlet")),2&o&&(e.xp6(4),e.Q6J("routerLink",e.DdM(1,y)))},dependencies:[u.lC,u.rH,u.Od]})}return s})();var m=c(4004),r=c(9996);class v{constructor(){this.db=(0,r.ad)(),this.enablePersistence()}enablePersistence(){(0,r.ST)(this.db).catch(i=>{"failed-precondition"==i.code?console.log("persistance failed"):"unimplemented"==i.code&&console.log("persistance not available")})}create(i){const t=(0,r.hJ)(this.db,this.basePath);return(0,r.ET)(t,{createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)(),...i})}update(i,t){const o=(0,r.JU)(this.db,this.basePath,i);return(0,r.r7)(o,{updatedAt:(0,r.Bt)(),...t})}delete(i){const t=(0,r.JU)(this.db,this.basePath,i);return(0,r.oe)(t)}doc(i){const t=(0,r.JU)(this.db,this.basePath,i);return new Promise((o,n)=>(0,r.QT)(t).then(l=>{let h=this.transformSingleDoc(l);o(h)}).catch(l=>{n(l.message)}))}docRealtime(i,t){const o=(0,r.JU)(this.db,this.basePath,i);return(0,r.cf)(o,n=>{t(this.transformSingleDoc(n))})}collection(){const i=(0,r.hJ)(this.db,this.basePath);return new Promise((t,o)=>{(0,r.PL)(i).then(n=>{let l=this.setData2(n);t(l)}).catch(n=>{o(n.message)})})}collectionRealtime(i){const t=(0,r.hJ)(this.db,this.basePath);return this.unsubscribe=(0,r.cf)(t,o=>{let n=this.setData2(o);i(n)})}unsubscribeCollectionRealtime(){this.unsubscribe()}setData2(i){let t=[];return i.docs.forEach(o=>{t.push({...o.data(),id:o.id})}),t}setData(i){return i.docs.map(t=>({id:t.id,...t.data()}))}transformSingleDoc(i){return{...i.data(),id:i.id}}}let b=(()=>{class s extends v{constructor(){super(...arguments),this.basePath="employees"}static#e=this.\u0275fac=function(){let t;return function(n){return(t||(t=e.n5z(s)))(n||s)}}();static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var Z=c(1135);class U{constructor(i){this.bs=new Z.X(i),this.state$=this.bs.asObservable(),this.state=i,this.state$.subscribe(t=>{this.state=t})}patch(i,t="Not specified"){this.previous=this.state;const o=Object.assign({},this.state,i);this.bs.next(o)}set(i,t="Not specified"){this.previous=this.state;const o=Object.assign({},i);this.bs.next(o)}}let A=(()=>{class s extends U{constructor(){super({loading:!0,employees:[],totalDrivers:0,totalEmployees:0,totalRosarioEmployees:0}),this.store="employees-page"}static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})(),d=(()=>{class s{constructor(t,o){this.firestore=t,this.store=o,this.firestore.collectionRealtime(n=>{this.store.patch({loading:!1,employees:n,totalEmployees:n.length,totalDrivers:n.filter(l=>l.hasDriverLicense).length,totalRosarioEmployees:n.filter(l=>"Rosario"===l.location).length},"employees collection subscription")})}get employees$(){return this.store.state$.pipe((0,m.U)(t=>t.loading?[]:t.employees))}get loading$(){return this.store.state$.pipe((0,m.U)(t=>t.loading))}get noResults$(){return this.store.state$.pipe((0,m.U)(t=>!t.loading&&t.employees&&0===t.employees.length))}get formStatus$(){return this.store.state$.pipe((0,m.U)(t=>t.formStatus))}create(t){return this.store.patch({loading:!0,employees:[],formStatus:"Saving..."},"employee create"),this.firestore.create(t).then(o=>{this.store.patch({formStatus:"Saved!"},"employee create SUCCESS"),setTimeout(()=>this.store.patch({formStatus:""},"employee create timeout reset formStatus"),2e3)}).catch(o=>{this.store.patch({loading:!1,formStatus:"An error ocurred"},"employee create ERROR")})}delete(t){return this.store.patch({loading:!0,employees:[]},"employee delete"),this.firestore.delete(t).catch(o=>{this.store.patch({loading:!1,formStatus:"An error ocurred"},"employee delete ERROR")})}get totalEmployees$(){return this.store.state$.pipe((0,m.U)(t=>t.totalEmployees))}get totalDrivers$(){return this.store.state$.pipe((0,m.U)(t=>t.totalDrivers))}get totalRosarioEmployees$(){return this.store.state$.pipe((0,m.U)(t=>t.totalRosarioEmployees))}static#e=this.\u0275fac=function(o){return new(o||s)(e.LFG(b),e.LFG(A))};static#t=this.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();function T(s,i){1&s&&(e.TgZ(0,"div"),e._uU(1," Loading...\n"),e.qZA())}function _(s,i){1&s&&(e.TgZ(0,"div"),e._uU(1," No results\n"),e.qZA())}function $(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3),e._uU(2),e.qZA(),e.TgZ(3,"div",4)(4,"h5",5),e._uU(5),e.qZA(),e.TgZ(6,"p",6),e._uU(7),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){const l=e.CHM(t).$implicit,h=e.oxw();return e.KtG(h.delete(l))}),e._uU(9,"Delete"),e.qZA()()()}if(2&s){const t=i.$implicit;e.xp6(2),e.Oqu(t.location),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.hasDriverLicense?"Can drive":"")}}let E=(()=>{class s{constructor(t){this.employees=t}ngOnInit(){this.loading$=this.employees.loading$,this.noResults$=this.employees.noResults$,this.employees$=this.employees.employees$}delete(t){this.employees.delete(t.id)}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(d))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees-list"]],decls:6,vars:9,consts:[[4,"ngIf"],["class","card bg-light mb-3","style","max-width: 18rem;",4,"ngFor","ngForOf"],[1,"card","bg-light","mb-3",2,"max-width","18rem"],[1,"card-header"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-danger",3,"click"]],template:function(o,n){1&o&&(e.YNc(0,T,2,0,"div",0),e.ALo(1,"async"),e.YNc(2,_,2,0,"div",0),e.ALo(3,"async"),e.YNc(4,$,10,3,"div",1),e.ALo(5,"async")),2&o&&(e.Q6J("ngIf",e.lcZ(1,3,n.loading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,5,n.noResults$)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,7,n.employees$)))},dependencies:[p.sg,p.O5,p.Ov]})}return s})();var C=c(9671),a=c(4006);function S(s,i){if(1&s&&(e.TgZ(0,"option",13),e._uU(1),e.qZA()),2&s){const t=i.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Oqu(t)}}let R=(()=>{class s{constructor(t){this.employees=t,this.form=new a.cw({name:new a.NI("",a.kI.required),location:new a.NI("",a.kI.required),hasDriverLicense:new a.NI(!1)}),this.locations=["Rosario","Buenos Aires","Bariloche"]}ngOnInit(){this.status$=this.employees.formStatus$}isInvalid(t){return this.form.controls[t].invalid&&(this.form.controls[t].dirty||this.form.controls[t].touched)}submit(){var t=this;return(0,C.Z)(function*(){t.form.disable(),yield t.employees.create({...t.form.value}),t.form.reset(),t.form.enable()})()}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(d))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees-form"]],decls:23,vars:10,consts:[[3,"formGroup","ngSubmit"],[1,"form-group"],["for","name"],["type","string","id","name","formControlName","name",1,"form-control"],[1,"invalid-feedback"],["formControlName","location",1,"custom-select"],["value","","selected",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group","form-check"],["type","checkbox","id","hasDriverLicense","formControlName","hasDriverLicense",1,"form-check-input"],["for","hasDriverLicense",1,"form-check-label"],["type","submit",1,"btn","btn-primary","d-inline",3,"disabled"],[1,"ml-2"],[3,"ngValue"]],template:function(o,n){1&o&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.submit()}),e.TgZ(1,"div",1)(2,"label",2),e._uU(3,"Name"),e.qZA(),e._UZ(4,"input",3),e.TgZ(5,"div",4),e._uU(6," Please enter a Name. "),e.qZA()(),e.TgZ(7,"div",1)(8,"select",5)(9,"option",6),e._uU(10,"Choose location"),e.qZA(),e.YNc(11,S,2,2,"option",7),e.qZA(),e.TgZ(12,"div",4),e._uU(13," Please select a Location. "),e.qZA()(),e.TgZ(14,"div",8),e._UZ(15,"input",9),e.TgZ(16,"label",10),e._uU(17,"Has driver license"),e.qZA()(),e.TgZ(18,"button",11),e._uU(19,"Add"),e.qZA(),e.TgZ(20,"span",12),e._uU(21),e.ALo(22,"async"),e.qZA()()),2&o&&(e.Q6J("formGroup",n.form),e.xp6(4),e.ekj("is-invalid",n.isInvalid("name")),e.xp6(4),e.ekj("is-invalid",n.isInvalid("location")),e.xp6(3),e.Q6J("ngForOf",n.locations),e.xp6(7),e.Q6J("disabled",n.form.invalid),e.xp6(3),e.Oqu(e.lcZ(22,8,n.status$)))},dependencies:[p.sg,a._Y,a.YN,a.Kr,a.Fj,a.Wl,a.EJ,a.JJ,a.JL,a.sg,a.u,p.Ov]})}return s})(),L=(()=>{class s{constructor(t){this.employees=t}ngOnInit(){this.total$=this.employees.totalEmployees$,this.drivers$=this.employees.totalDrivers$,this.rosario$=this.employees.totalRosarioEmployees$}static#e=this.\u0275fac=function(o){return new(o||s)(e.Y36(d))};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees-summary"]],decls:16,vars:9,consts:[[1,"font-weight-bold"]],template:function(o,n){1&o&&(e.TgZ(0,"p")(1,"span",0),e._uU(2,"Total:"),e.qZA(),e._uU(3),e.ALo(4,"async"),e._UZ(5,"br"),e.TgZ(6,"span",0),e._uU(7,"Drivers:"),e.qZA(),e._uU(8),e.ALo(9,"async"),e._UZ(10,"br"),e.TgZ(11,"span",0),e._uU(12,"Rosario:"),e.qZA(),e._uU(13),e.ALo(14,"async"),e._UZ(15,"br"),e.qZA()),2&o&&(e.xp6(3),e.hij(" ",e.lcZ(4,3,n.total$)," "),e.xp6(5),e.hij(" ",e.lcZ(9,5,n.drivers$)," "),e.xp6(5),e.hij(" ",e.lcZ(14,7,n.rosario$)," "))},dependencies:[p.Ov]})}return s})();const F=[{path:"",component:g,children:[{path:"employeesPage",component:(()=>{class s{constructor(){}ngOnInit(){}static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-employees-page"]],decls:11,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-12","mb-3"],[1,"col-6"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4"),e._uU(4," Employees "),e.qZA(),e._UZ(5,"app-employees-summary"),e.qZA()(),e.TgZ(6,"div",1)(7,"div",3),e._UZ(8,"app-employees-list"),e.qZA(),e.TgZ(9,"div",3),e._UZ(10,"app-employees-form"),e.qZA()()())},dependencies:[E,R,L]})}return s})()}]}];let O=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[u.Bz.forChild(F),u.Bz]})}return s})(),q=(()=>{class s{static#e=this.\u0275fac=function(o){return new(o||s)};static#t=this.\u0275mod=e.oAB({type:s});static#s=this.\u0275inj=e.cJS({imports:[p.ez,a.UX,O]})}return s})()}}]);