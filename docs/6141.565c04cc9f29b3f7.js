"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[6141],{6779:(j,b,d)=>{d.d(b,{C:()=>g});var m=d(5861),o=d(9996),s=d(4716);class g{constructor(){this.db=(0,o.ad)(),this.auth=(0,s.v0)(),(0,o.ST)(this.db).catch(t=>{"failed-precondition"==t.code?console.log("persistance failed"):"unimplemented"==t.code&&console.log("persistance not available")})}get colRef(){return(0,o.hJ)(this.db,this.collectionPath)}getCollectionData(){return new Promise((t,a)=>{(0,o.PL)(this.colRef).then(c=>{let u=this.setData2(c);t(u)}).catch(c=>{a(c.message)})})}getSingleDoc(t){const a=(0,o.JU)(this.db,this.collectionPath,t);return new Promise((c,u)=>(0,o.QT)(a).then(p=>{let f=this.transformSingleDoc(p);c(f)}).catch(p=>{u(p.message)}))}getSingleDocFromCache(t){var a=this;return(0,m.Z)(function*(){const c=(0,o.JU)(a.db,a.collectionPath,t);try{const u=yield(0,o.kl)(c);console.log("Cached document data:",u.data())}catch(u){console.log("Error getting cached document:",u)}})()}getCollectionRealTime(t){return this.unsubscribe=(0,o.cf)(this.colRef,a=>{t(this.setData2(a))})}g(){(0,o.cf)(void 0,a=>{a.docChanges().forEach(c=>{"added"===c.type&&console.log("New city: ",c.doc.data()),"modified"===c.type&&console.log("Modified city: ",c.doc.data()),"removed"===c.type&&console.log("Removed city: ",c.doc.data())})})}getDocRealTime(t,a){const c=(0,o.JU)(this.db,this.collectionPath,t);return(0,o.cf)(c,u=>{a(this.transformSingleDoc(u))})}addingDoc(t={}){return(0,o.ET)(this.colRef,Object.assign({createdAt:(0,o.Bt)(),updatedAt:(0,o.Bt)()},t))}deletingDoc(t){const a=(0,o.JU)(this.db,this.collectionPath,t);return(0,o.oe)(a)}updatingDoc(t,a){const c=(0,o.JU)(this.db,this.collectionPath,t);return(0,o.r7)(c,Object.assign({updatedAt:(0,o.Bt)()},a))}signUpWithEmailPass({email:t,password:a}){return(0,s.Xb)(this.auth,t,a).then(c=>Promise.resolve(c.user)).catch(c=>Promise.reject(c.message))}signInWithEmailPass({email:t,password:a}){return(0,s.e5)(this.auth,t,a).then(c=>Promise.resolve(c.user)).catch(c=>Promise.reject(c.message))}onSignOut(){return(0,s.w7)(this.auth).then(t=>Promise.resolve(t)).catch(t=>Promise.reject(t.message))}subscribingAuthChangedRealTime(t){return(0,s.Aj)(this.auth,a=>{t(a)})}getPaginationData1(t={latestDoc:null,empty:!1,data:[]},a=5){return new Promise((c,u)=>{const p=(0,o.IO)(this.colRef,(0,o.Xo)("createdAt"),(0,o.TQ)(t.latestDoc||0),(0,o.b9)(a));(0,o.PL)(p).then(f=>{let _=this.setData2(f);t.latestDoc=f.docs[f.docs.length-1],t.data=[...t.data,..._],t.empty=f.empty,c(t)}).catch(f=>{u(f.message)})})}getPaginationData(t={latestDoc:null,empty:!1,data:[],size:0},a=5){var c=this;return(0,m.Z)(function*(){if(!t.empty)try{const u=(0,o.IO)(c.colRef,(0,o.Xo)("createdAt"),(0,o.TQ)(t.latestDoc||0),(0,o.b9)(a)),p=yield(0,o.PL)(u);let f=c.setData2(p);return t.latestDoc=p.docs[p.docs.length-1],t.data=[...t.data,...f],t.empty=p.empty,t.size=p.size,t}catch(u){return u}})()}unsubscribeRealTime(){this.unsubscribe()}nextPage(t={latestDoc:null,empty:!1,data:[],size:0},a=5){var c=this;return(0,m.Z)(function*(){const u=(0,o.IO)(c.colRef,(0,o.Xo)("createdAt"),(0,o.TQ)(t.latestDoc||0),(0,o.b9)(a));return yield c.handlePagination(u)})()}prePage(t={latestDoc:null,empty:!1,data:[],size:0},a=5){var c=this;return(0,m.Z)(function*(){const u=(0,o.IO)(c.colRef,(0,o.Xo)("createdAt"),(0,o.Lx)(t.latestDoc||0),(0,o.b9)(a));return yield c.handlePagination(u,!1)})()}setData(t){return t.docs.map(a=>Object.assign({id:a.id},a.data()))}setData2(t){let a=[];return t.docs.forEach(c=>{a.push(Object.assign(Object.assign({},c.data()),{id:c.id}))}),a}transformSingleDoc(t){return Object.assign(Object.assign({},t.data()),{id:t.id})}handlePagination(t,a=!0){var c=this;return(0,m.Z)(function*(){try{const u=yield(0,o.PL)(t);let p=c.setData2(u);return{latestDoc:a?u.docs[u.docs.length-1]:u.docs[0],data:p,empty:u.empty,size:u.size}}catch(u){return u}})()}}},6141:(j,b,d)=>{d.d(b,{f8:()=>v,Qi:()=>a});var m=d(5e3),o=d(5861),s=d(6197),g=d(9751);class v{constructor(){this.db=(0,s.N8)()}create(i,e={}){let r=(0,s.VF)((0,s.iH)(this.db,i));return(0,s.t8)(r,Object.assign({key:r.key},e)).then(),Promise.resolve({key:r.key})}set(i,e={}){var r=this;return(0,o.Z)(function*(){const l=(0,s.iH)(r.db,i);yield(0,s.t8)(l,e)})()}update(i,e={}){var r=this;return(0,o.Z)(function*(){const l=(0,s.iH)(r.db,i);yield(0,s.Vx)(l,e)})()}remove(i){var e=this;return(0,o.Z)(function*(){const r=(0,s.iH)(e.db,i);yield(0,s.Od)(r)})()}readRealTime(i){return new g.y(e=>{(0,s.jM)((0,s.iH)(this.db,i),r=>{let l=[];r.exists()?(r.forEach(h=>{l.push(Object.assign({key:h.key},h.val()))}),e.next(l)):e.next([])})})}readOnceWithObserver(i){return(0,s.jM)((0,s.iH)(this.db,i),e=>e.val(),{onlyOnce:!0})}readOnce(i){return new Promise((e,r)=>{(0,s.U2)((0,s.iH)(this.db,i)).then(l=>{l.exists()?e(Object.assign({key:l.key},l.val())):e([])}).catch(l=>{r(l)})})}readReal(i){return new g.y(e=>{(0,s.jM)((0,s.iH)(this.db,i),r=>{r.exists()?e.next(r.val()):e.next(null)})})}updateCounter(i,e=!0){return new Promise((r,l)=>{const h=(0,s.iH)(this.db);(0,s.U2)((0,s.iU)(h,"counter")).then(y=>{(0,s.Vx)((0,s.iH)(this.db,i),{counter:(0,s.nP)(e?1:-1)}).then(A=>{r(A)})})})}others(){}checkPresence(i){const e=(0,s.iH)(this.db,`${i}/connections`),r=(0,s.iH)(this.db,`${i}/lastOnline`),l=(0,s.iH)(this.db,".info/connected");(0,s.jM)(l,h=>{if(!0===h.val()){const y=(0,s.VF)(e);(0,s.ae)(y).remove().then(),(0,s.t8)(y,!0).then(),(0,s.ae)(r).set((0,s.Bt)()).then()}})}onDisconnect(i){const e=(0,s.iH)(this.db,i);return(0,s.ae)(e)}detectingConnectionState(){return new g.y(i=>{const e=(0,s.iH)(this.db,".info/connected");(0,s.jM)(e,r=>{i.next(r.val())})})}}var t=d(4004);let a=(()=>{class n extends v{constructor(){super()}get timestamp(){return(new Date).getTime()}getPresence(e){return this.readReal(`status/${e}`)}getUserOnlineCounts(){return this.readRealTime("status").pipe((0,t.U)(e=>e.reduce((r,l)=>"online"===l.status?++r:r,0)))}getTotalUserCounts(){return this.readRealTime("status").pipe((0,t.U)(e=>e))}getUser(){}setPresence(e,r){return("offline"===r||"away"===r)&&this.updateCounter("online-users",!1).then(),"online"===r&&this.updateCounter("online-users",!0).then(),this.set(`status/${e}`,{status:r,timestamp:this.timestamp})}updateOnAway(e){document.onvisibilitychange=r=>{"hidden"===document.visibilityState?this.setPresence(e,"away"):this.setPresence(e,"online")}}updateOnUser(e){this.detectingConnectionState().pipe((0,t.U)(l=>l?"online":"offline")).subscribe(l=>this.setPresence(e,l))}updateOnDisconnect(e){this.onDisconnect(`status/${e}`).update({status:"offline",timestamp:this.timestamp})}configure(e){this.updateOnAway(e),this.updateOnUser(e),this.updateOnDisconnect(e)}configureUserPresenceByLocal(){let e=localStorage.getItem("uid");this.checkingUser(e)}configureUserPresenceByLogin(e,r={}){this.checkingUser(e,r)}checkingUser(e,r={}){e?this.configure(e):this.create("status",Object.assign({uid:e},r)).then(l=>{localStorage.setItem("uid",l.key),this.configure(l.key)})}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=m.Yz7({token:n,factory:n.\u0275fac}),n})();d(4202),d(520),d(259),d(9996),new m.OlP(null),d(6779)}}]);