"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[1124],{1124:(q,h,c)=>{c.r(h),c.d(h,{EmployeesModule:()=>x});var p=c(9808),u=c(4202),e=c(5e3);const g=function(){return["./employeesPage"]};let f=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-employees"]],decls:8,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light","mb-3"],[1,"navbar-brand","mb-0","h1"],[1,"navbar-nav","mr-auto"],["routerLinkActive","active",1,"nav-item",3,"routerLink"],[1,"nav-link"]],template:function(t,n){1&t&&(e.TgZ(0,"nav",0)(1,"span",1),e._uU(2,"Angular + Firebase + State Management"),e.qZA(),e.TgZ(3,"ul",2)(4,"li",3)(5,"a",4),e._uU(6,"Employees"),e.qZA()()()(),e._UZ(7,"router-outlet")),2&t&&(e.xp6(4),e.Q6J("routerLink",e.DdM(1,g)))},dependencies:[u.lC,u.rH,u.Od]}),o})();var m=c(4004),r=c(9996);let b=(()=>{class o extends class v{constructor(){this.db=(0,r.ad)(),(0,r.ST)(this.db).catch(s=>{"failed-precondition"==s.code?console.log("persistance failed"):"unimplemented"==s.code&&console.log("persistance not available")})}doc(s){const t=(0,r.JU)(this.db,this.basePath,s);return new Promise((n,l)=>(0,r.QT)(t).then(a=>{console.groupCollapsed(`Firestore Streaming [${this.basePath}] [doc$] ${s}`),console.log(a),console.groupEnd(),n(a)}).catch(a=>{l(a.message)}))}collection(){const s=(0,r.hJ)(this.db,this.basePath);return new Promise((t,n)=>{(0,r.PL)(s).then(l=>{let a=this.setData2(l);t(a)}).catch(l=>{n(l.message)})})}collectionRealtime(s){const t=(0,r.hJ)(this.db,this.basePath);return(0,r.cf)(t,n=>{let l=this.setData2(n);s(l)})}create(s){const t=(0,r.hJ)(this.db,this.basePath);return(0,r.ET)(t,Object.assign({createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)()},s))}delete(s){const t=(0,r.JU)(this.db,this.basePath,s);return(0,r.oe)(t)}update(s,t){const n=(0,r.JU)(this.db,this.basePath,s);return(0,r.r7)(n,Object.assign({updatedAt:(0,r.Bt)()},t))}setData2(s){let t=[];return s.docs.forEach(n=>{t.push(Object.assign(Object.assign({},n.data()),{id:n.id}))}),t}}{constructor(){super(...arguments),this.basePath="employees"}}return o.\u0275fac=function(){let s;return function(n){return(s||(s=e.n5z(o)))(n||o)}}(),o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var E=c(1135),y=c(5159);let $=(()=>{class o extends class Z{constructor(s){this.bs=new E.X(s),this.state$=this.bs.asObservable(),this.state=s,this.state$.subscribe(t=>{this.state=t})}patch(s,t="Not specified"){this.previous=this.state;const n=Object.assign({},this.state,s);y.N.production||(console.groupCollapsed(`[${this.store} store] [patch] [event: ${t}]`),console.log("change",s),console.log("prev",this.previous),console.log("next",n),console.groupEnd()),this.bs.next(n)}set(s,t="Not specified"){this.previous=this.state;const n=Object.assign({},s);y.N.production||(console.groupCollapsed(`[${this.store} store] [set] [event: ${t}]`),console.log("change",s),console.log("prev",this.previous),console.log("next",n),console.groupEnd()),this.bs.next(n)}}{constructor(){super({loading:!0,employees:[],totalDrivers:0,totalEmployees:0,totalRosarioEmployees:0}),this.store="employees-page"}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),d=(()=>{class o{constructor(t,n){this.firestore=t,this.store=n,this.firestore.collectionRealtime(l=>{this.store.patch({loading:!1,employees:l,totalEmployees:l.length,totalDrivers:l.filter(a=>a.hasDriverLicense).length,totalRosarioEmployees:l.filter(a=>"Rosario"===a.location).length},"employees collection subscription")})}get employees$(){return this.store.state$.pipe((0,m.U)(t=>t.loading?[]:t.employees))}get loading$(){return this.store.state$.pipe((0,m.U)(t=>t.loading))}get noResults$(){return this.store.state$.pipe((0,m.U)(t=>!t.loading&&t.employees&&0===t.employees.length))}get formStatus$(){return this.store.state$.pipe((0,m.U)(t=>t.formStatus))}create(t){return this.store.patch({loading:!0,employees:[],formStatus:"Saving..."},"employee create"),this.firestore.create(t).then(n=>{this.store.patch({formStatus:"Saved!"},"employee create SUCCESS"),setTimeout(()=>this.store.patch({formStatus:""},"employee create timeout reset formStatus"),2e3)}).catch(n=>{this.store.patch({loading:!1,formStatus:"An error ocurred"},"employee create ERROR")})}delete(t){return this.store.patch({loading:!0,employees:[]},"employee delete"),this.firestore.delete(t).catch(n=>{this.store.patch({loading:!1,formStatus:"An error ocurred"},"employee delete ERROR")})}get totalEmployees$(){return this.store.state$.pipe((0,m.U)(t=>t.totalEmployees))}get totalDrivers$(){return this.store.state$.pipe((0,m.U)(t=>t.totalDrivers))}get totalRosarioEmployees$(){return this.store.state$.pipe((0,m.U)(t=>t.totalRosarioEmployees))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(b),e.LFG($))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function C(o,s){1&o&&(e.TgZ(0,"div"),e._uU(1," Loading...\n"),e.qZA())}function U(o,s){1&o&&(e.TgZ(0,"div"),e._uU(1," No results\n"),e.qZA())}function A(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div",2)(1,"div",3),e._uU(2),e.qZA(),e.TgZ(3,"div",4)(4,"h5",5),e._uU(5),e.qZA(),e.TgZ(6,"p",6),e._uU(7),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){const a=e.CHM(t).$implicit,P=e.oxw();return e.KtG(P.delete(a))}),e._uU(9,"Delete"),e.qZA()()()}if(2&o){const t=s.$implicit;e.xp6(2),e.Oqu(t.location),e.xp6(3),e.Oqu(t.name),e.xp6(2),e.Oqu(t.hasDriverLicense?"Can drive":"")}}let T=(()=>{class o{constructor(t){this.employees=t}ngOnInit(){this.loading$=this.employees.loading$,this.noResults$=this.employees.noResults$,this.employees$=this.employees.employees$}delete(t){this.employees.delete(t.id)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-employees-list"]],decls:6,vars:9,consts:[[4,"ngIf"],["class","card bg-light mb-3","style","max-width: 18rem;",4,"ngFor","ngForOf"],[1,"card","bg-light","mb-3",2,"max-width","18rem"],[1,"card-header"],[1,"card-body"],[1,"card-title"],[1,"card-text"],[1,"btn","btn-danger",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,C,2,0,"div",0),e.ALo(1,"async"),e.YNc(2,U,2,0,"div",0),e.ALo(3,"async"),e.YNc(4,A,10,3,"div",1),e.ALo(5,"async")),2&t&&(e.Q6J("ngIf",e.lcZ(1,3,n.loading$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,5,n.noResults$)),e.xp6(2),e.Q6J("ngForOf",e.lcZ(5,7,n.employees$)))},dependencies:[p.sg,p.O5,p.Ov]}),o})();var S=c(5861),i=c(3075);function _(o,s){if(1&o&&(e.TgZ(0,"option",13),e._uU(1),e.qZA()),2&o){const t=s.$implicit;e.Q6J("ngValue",t),e.xp6(1),e.Oqu(t)}}let F=(()=>{class o{constructor(t){this.employees=t,this.form=new i.cw({name:new i.NI("",i.kI.required),location:new i.NI("",i.kI.required),hasDriverLicense:new i.NI(!1)}),this.locations=["Rosario","Buenos Aires","Bariloche"]}ngOnInit(){this.status$=this.employees.formStatus$}isInvalid(t){return this.form.controls[t].invalid&&(this.form.controls[t].dirty||this.form.controls[t].touched)}submit(){var t=this;return(0,S.Z)(function*(){t.form.disable(),yield t.employees.create(Object.assign({},t.form.value)),t.form.reset(),t.form.enable()})()}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-employees-form"]],decls:23,vars:10,consts:[[3,"formGroup","ngSubmit"],[1,"form-group"],["for","name"],["type","string","id","name","formControlName","name",1,"form-control"],[1,"invalid-feedback"],["formControlName","location",1,"custom-select"],["value","","selected",""],[3,"ngValue",4,"ngFor","ngForOf"],[1,"form-group","form-check"],["type","checkbox","id","hasDriverLicense","formControlName","hasDriverLicense",1,"form-check-input"],["for","hasDriverLicense",1,"form-check-label"],["type","submit",1,"btn","btn-primary","d-inline",3,"disabled"],[1,"ml-2"],[3,"ngValue"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.submit()}),e.TgZ(1,"div",1)(2,"label",2),e._uU(3,"Name"),e.qZA(),e._UZ(4,"input",3),e.TgZ(5,"div",4),e._uU(6," Please enter a Name. "),e.qZA()(),e.TgZ(7,"div",1)(8,"select",5)(9,"option",6),e._uU(10,"Choose location"),e.qZA(),e.YNc(11,_,2,2,"option",7),e.qZA(),e.TgZ(12,"div",4),e._uU(13," Please select a Location. "),e.qZA()(),e.TgZ(14,"div",8),e._UZ(15,"input",9),e.TgZ(16,"label",10),e._uU(17,"Has driver license"),e.qZA()(),e.TgZ(18,"button",11),e._uU(19,"Add"),e.qZA(),e.TgZ(20,"span",12),e._uU(21),e.ALo(22,"async"),e.qZA()()),2&t&&(e.Q6J("formGroup",n.form),e.xp6(4),e.ekj("is-invalid",n.isInvalid("name")),e.xp6(4),e.ekj("is-invalid",n.isInvalid("location")),e.xp6(3),e.Q6J("ngForOf",n.locations),e.xp6(7),e.Q6J("disabled",n.form.invalid),e.xp6(3),e.Oqu(e.lcZ(22,8,n.status$)))},dependencies:[p.sg,i._Y,i.YN,i.Kr,i.Fj,i.Wl,i.EJ,i.JJ,i.JL,i.sg,i.u,p.Ov]}),o})(),L=(()=>{class o{constructor(t){this.employees=t}ngOnInit(){this.total$=this.employees.totalEmployees$,this.drivers$=this.employees.totalDrivers$,this.rosario$=this.employees.totalRosarioEmployees$}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(d))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-employees-summary"]],decls:16,vars:9,consts:[[1,"font-weight-bold"]],template:function(t,n){1&t&&(e.TgZ(0,"p")(1,"span",0),e._uU(2,"Total:"),e.qZA(),e._uU(3),e.ALo(4,"async"),e._UZ(5,"br"),e.TgZ(6,"span",0),e._uU(7,"Drivers:"),e.qZA(),e._uU(8),e.ALo(9,"async"),e._UZ(10,"br"),e.TgZ(11,"span",0),e._uU(12,"Rosario:"),e.qZA(),e._uU(13),e.ALo(14,"async"),e._UZ(15,"br"),e.qZA()),2&t&&(e.xp6(3),e.hij(" ",e.lcZ(4,3,n.total$)," "),e.xp6(5),e.hij(" ",e.lcZ(9,5,n.drivers$)," "),e.xp6(5),e.hij(" ",e.lcZ(14,7,n.rosario$)," "))},dependencies:[p.Ov]}),o})();const O=[{path:"",component:f,children:[{path:"employeesPage",component:(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-employees-page"]],decls:11,vars:0,consts:[[1,"container"],[1,"row"],[1,"col-12","mb-3"],[1,"col-6"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h4"),e._uU(4," Employees "),e.qZA(),e._UZ(5,"app-employees-summary"),e.qZA()(),e.TgZ(6,"div",1)(7,"div",3),e._UZ(8,"app-employees-list"),e.qZA(),e.TgZ(9,"div",3),e._UZ(10,"app-employees-form"),e.qZA()()())},dependencies:[T,F,L]}),o})()}]}];let R=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[u.Bz.forChild(O),u.Bz]}),o})(),x=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.ez,i.UX,R]}),o})()}}]);