"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[5386],{5386:(p,d,n)=>{n.r(d),n.d(d,{default:()=>h});var r=n(4438),o=n(9417),g=n(7765);let m=(()=>{class a extends g.u{constructor(){super(...arguments),this.basePath="figmaLite-db",this.endpoint=""}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=r.xGo(a)))(i||a)}})()}static{this.\u0275prov=r.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();const f=["canvas"];let h=(()=>{class a{constructor(){this.strokeColor="#000000",this.strokeWidth=2,this.roomId="room-1",this.strokes=[],this.currentStroke=null,this.ds=(0,r.WQX)(m),this.userId=Math.random().toString(36).substring(2,7)}ngOnInit(){this.ctx=this.canvasRef.nativeElement.getContext("2d"),this.setupCanvas(),this.ds.getById(this.roomId).subscribe(t=>{this.strokes=t?.data??[],console.log(t),this.redrawAll()})}setupCanvas(){const t=this.canvasRef.nativeElement;t.addEventListener("mousedown",e=>this.startStroke(e)),t.addEventListener("mousemove",e=>this.moveStroke(e)),t.addEventListener("mouseup",()=>this.endStroke()),t.addEventListener("mouseleave",()=>this.endStroke())}startStroke(t){const e=this.relativePos(t);this.currentStroke={points:[e],color:this.strokeColor,width:this.strokeWidth,layerId:"base",userId:this.userId}}moveStroke(t){if(!this.currentStroke)return;const e=this.relativePos(t);this.currentStroke.points.push(e),this.drawLineSegment(this.currentStroke.points)}endStroke(){if(!this.currentStroke)return;const t=this.currentStroke;this.currentStroke=null;const e=[...this.strokes,t];this.ds.update(this.roomId,{data:e})}redrawAll(){const t=this.canvasRef.nativeElement;this.ctx.clearRect(0,0,t.width,t.height),this.strokes?.forEach(e=>this.drawWholeStroke(e))}drawWholeStroke(t){const e=t.points;e.length<2||(this.ctx.strokeStyle=t.color,this.ctx.lineWidth=t.width,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(e[0].x,e[0].y),e.slice(1).forEach(i=>this.ctx.lineTo(i.x,i.y)),this.ctx.stroke())}drawLineSegment(t){const e=t,i=e.length;i<2||(this.ctx.strokeStyle=this.strokeColor,this.ctx.lineWidth=this.strokeWidth,this.ctx.lineCap="round",this.ctx.beginPath(),this.ctx.moveTo(e[i-2].x,e[i-2].y),this.ctx.lineTo(e[i-1].x,e[i-1].y),this.ctx.stroke())}relativePos(t){const e=this.canvasRef.nativeElement.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}clearCanvas(){}static{this.\u0275fac=function(e){return new(e||a)}}static{this.\u0275cmp=r.VBU({type:a,selectors:[["app-figma-lite"]],viewQuery:function(e,i){if(1&e&&r.GBs(f,7),2&e){let l;r.mGM(l=r.lsd())&&(i.canvasRef=l.first)}},decls:11,vars:2,consts:[["canvas",""],[1,"toolbar"],["type","color",3,"ngModelChange","ngModel"],["type","range","min","1","max","20",3,"ngModelChange","ngModel"],[3,"click"],["width","800","height","600",1,"drawing-board"]],template:function(e,i){if(1&e){const l=r.RV6();r.j41(0,"div",1)(1,"label"),r.EFF(2,"Color: "),r.j41(3,"input",2),r.mxI("ngModelChange",function(c){return r.eBV(l),r.DH7(i.strokeColor,c)||(i.strokeColor=c),r.Njj(c)}),r.k0s()(),r.j41(4,"label"),r.EFF(5,"Size: "),r.j41(6,"input",3),r.mxI("ngModelChange",function(c){return r.eBV(l),r.DH7(i.strokeWidth,c)||(i.strokeWidth=c),r.Njj(c)}),r.k0s()(),r.j41(7,"button",4),r.bIt("click",function(){return r.eBV(l),r.Njj(i.clearCanvas())}),r.EFF(8,"Clear"),r.k0s()(),r.nrm(9,"canvas",5,0)}2&e&&(r.R7$(3),r.R50("ngModel",i.strokeColor),r.R7$(3),r.R50("ngModel",i.strokeWidth))},dependencies:[o.YN,o.me,o.MR,o.BC,o.vS],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center;font-family:sans-serif}.toolbar[_ngcontent-%COMP%]{margin-bottom:8px;display:flex;gap:12px;align-items:center;background:#f8f9fa;padding:8px 12px;border-radius:6px}canvas.drawing-board[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;background:#fff;cursor:crosshair}"]})}}return a})()},7765:(p,d,n)=>{n.d(d,{u:()=>f});var r=n(467),o=n(4438),g=n(9972),m=n(1469);let f=(()=>{class h{constructor(){this.db=(0,o.WQX)(g.h),this.storageService=(0,o.WQX)(m._)}get fullPath(){return`${this.basePath}/${this.endpoint}`}generatePath(s=""){return s?`${this.fullPath}/${s}`:this.fullPath}create(s,t){return this.db.create(this.generatePath(t),s)}get$(){return this.db.readRealtime$(this.fullPath)}getById(s){return this.db.readRealtimeOriginal$(`${this.fullPath}/${s}`)}update(s,t){return this.db.update(`${this.fullPath}/${s}`,t)}remove(s){return this.db.remove(`${this.fullPath}/${s}`)}set(s,t){return this.db.set(this.generatePath(s),t)}getKeys$(s=""){return this.db.getKeys$(this.generatePath(s))}getKeys(s=""){return this.db.getKeys(this.generatePath(s))}readOnce(s=""){return this.db.readOnce(this.generatePath(s))}read$(s=""){return this.db.readRealtime$(this.generatePath(s))}clearDb(){return this.set("",null)}updateCounter(s,t=!0){return this.db.updateCounterV2(this.generatePath(s),t)}createWithFile(s,t,e){var i=this;return(0,r.A)(function*(){if(!t)throw new Error("Please select an image.");const l=yield i.storageService.uploadFile(i.basePath,t,e),u={...s,imageUrl:l};yield i.create(u)})()}uploadFile(s,t){var e=this;return(0,r.A)(function*(){if(!s)throw new Error("Please select an image.");return yield e.storageService.uploadFile(e.basePath,s,t)})()}extractAndUploadFiles(s,t){var e=this;return(0,r.A)(function*(){return e.storageService.extractAndUploadFiles(s,e.basePath,t)})()}static{this.\u0275fac=function(t){return new(t||h)}}static{this.\u0275prov=o.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()}}]);