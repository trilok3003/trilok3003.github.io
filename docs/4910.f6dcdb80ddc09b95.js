"use strict";(self.webpackChunkportfolio_all_in_one=self.webpackChunkportfolio_all_in_one||[]).push([[4910],{468:(E,v,f)=>{f.d(v,{e:()=>D});var t=f(4438);function b(g,F){if(1&g){const r=t.RV6();t.j41(0,"button",4),t.bIt("click",function(){const l=t.eBV(r).$implicit,S=t.XpG(2);return t.Njj(S.onPageChange(l))}),t.EFF(1),t.k0s()}if(2&g){const r=F.$implicit,m=t.XpG(2);t.AVh("active",r===m.currentPage()),t.R7$(),t.SpI(" ",r," ")}}function h(g,F){if(1&g){const r=t.RV6();t.j41(0,"div",1)(1,"button",2),t.bIt("click",function(){t.eBV(r);const l=t.XpG();return t.Njj(l.onPageChange(l.currentPage()-1))}),t.EFF(2," \u2190 Prev "),t.k0s(),t.Z7z(3,b,2,3,"button",3,t.Vm6),t.j41(5,"button",2),t.bIt("click",function(){t.eBV(r);const l=t.XpG();return t.Njj(l.onPageChange(l.currentPage()+1))}),t.EFF(6," Next \u2192 "),t.k0s(),t.j41(7,"span"),t.EFF(8),t.k0s()()}if(2&g){const r=t.XpG();t.R7$(),t.Y8G("disabled",1===r.currentPage()),t.R7$(2),t.Dyx(r.visiblePages()),t.R7$(2),t.Y8G("disabled",r.currentPage()===r.totalPages()),t.R7$(3),t.Lme(" Page ",r.currentPage()," of ",r.totalPages(),"")}}function M(g,F){if(1&g){const r=t.RV6();t.j41(0,"div",1)(1,"button",2),t.bIt("click",function(){t.eBV(r);const l=t.XpG();return t.Njj(l.onPageChange(l.currentPage()-1))}),t.EFF(2," Prev "),t.k0s(),t.EFF(3),t.j41(4,"button",2),t.bIt("click",function(){t.eBV(r);const l=t.XpG();return t.Njj(l.onPageChange(l.currentPage()+1))}),t.EFF(5," Next "),t.k0s()()}if(2&g){const r=t.XpG();t.R7$(),t.Y8G("disabled",1===r.currentPage()),t.R7$(2),t.Lme(" Page ",r.currentPage()," of ",r.totalPages()," "),t.R7$(),t.Y8G("disabled",r.currentPage()===r.totalPages())}}let D=(()=>{class g{constructor(){this.currentPage=t.hFB.required(),this.totalItems=t.hFB.required(),this.pageSize=(0,t.hFB)(10),this.pageChange=(0,t.CGW)(),this.totalPages=(0,t.EWP)(()=>Math.ceil(this.totalItems()/this.pageSize())),this.visiblePages=(0,t.EWP)(()=>{const r=this.totalPages(),m=this.currentPage(),l=Math.max(1,m-1),S=Math.min(r,l+2);return Array.from({length:S-l+1},(O,k)=>l+k)})}onPageChange(r){const m=this.totalPages();r>=1&&r<=m&&this.pageChange.emit(r)}static{this.\u0275fac=function(m){return new(m||g)}}static{this.\u0275cmp=t.VBU({type:g,selectors:[["app-pagination"]],inputs:{currentPage:[1,"currentPage"],totalItems:[1,"totalItems"],pageSize:[1,"pageSize"]},outputs:{pageChange:"pageChange"},decls:3,vars:1,consts:[["paginationTemplate",""],[1,"pagination"],[3,"click","disabled"],[3,"active"],[3,"click"]],template:function(m,l){1&m&&t.DNE(0,h,9,4,"div",1)(1,M,6,4,"ng-template",null,0,t.C5r),2&m&&t.vxM(l.totalPages()?0:-1)},styles:['[_nghost-%COMP%]{--primary-color: #007bff;--border-color: #dee2e6;--text-color: #212529;--font-family: "Segoe UI", sans-serif;font-family:var(--font-family);color:var(--text-color)}.pagination[_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:center;align-items:center;margin-top:1rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid var(--border-color);background-color:#fff;border-radius:4px;min-width:36px;color:#000;cursor:pointer}.pagination[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{background-color:var(--primary-color);color:#fff;font-weight:700}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover:not(:disabled){opacity:.8}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}']})}}return g})()},4910:(E,v,f)=>{f.r(v),f.d(v,{default:()=>k});var t=f(4438),b=f(177),h=f(9417),M=f(2627),D=f(468);const g=[];var F=f(9468);let r=(()=>{class c{constructor(){this.exportService=(0,t.WQX)(F._),this.statements=g,this.uploadedStatements=[]}filterSortPaginate(n,o,e,i,a){let s=[...this.getAllStatements()];if(n.fromDate){const u=new Date(n.fromDate);s=s.filter(d=>{const _=this.parseCustomDate(d.date);return _&&_>=u})}if(n.toDate){const u=new Date(n.toDate);s=s.filter(d=>{const _=this.parseCustomDate(d.date);return _&&_<=u})}if("income"===n.type&&(s=s.filter(u=>u.amount>0)),"expense"===n.type&&(s=s.filter(u=>u.amount<0)),n.search){const u=n.search.trim().toLowerCase();s=s.filter(d=>d.description.toLowerCase().includes(u))}s.sort((u,d)=>{let _="date"===o?new Date(u.date).getTime():u[o],x="date"===o?new Date(d.date).getTime():d[o];return"asc"===e?_-x:x-_});const C=Math.ceil(s.length/a),y=s.slice((i-1)*a,i*a);return{filteredData:s,paginatedData:y,totalPages:C}}exportCSV(n,o){this.exportService.exportCSV(n,o,{headers:["Date","Description","Amount","Balance"],rowMapper:i=>[i.date,i.description,i.amount,i.balance]})}exportJSON(n,o){this.exportService.exportJSON(n,o)}exportPDF(n,o){this.exportService.exportPDF(n,o)}parseCustomDate(n){const o=n.split("/");if(3!==o.length)return null;let[e,i,a]=o.map(s=>parseInt(s,10));a<100&&(a+=a>=50?1900:2e3);const p=new Date(a,i-1,e);return isNaN(p.getTime())?null:p}groupByMonth(n){const o={};return n.forEach(e=>{const i=this.parseCustomDate(e.date),p=new Date(i.toISOString()).toLocaleString("default",{month:"long",year:"numeric"});o[p]||(o[p]={credit:0,debit:0}),e.amount>0?o[p].credit+=e.amount:o[p].debit+=Math.abs(e.amount)}),o}setUploadedStatements(n){this.uploadedStatements=n}getAllStatements(){return this.uploadedStatements.length?this.uploadedStatements:this.statements}getSummary(n){const o=n,e=o.length?o[0].balance-o[0].amount:0,i=o.length?o[o.length-1].balance:0,a=o.filter(d=>d.amount>0),p=o.filter(d=>d.amount<0);return{openingBalance:e,closingBalance:i,creditCount:a.length,debitCount:p.length,creditTotal:a.reduce((d,_)=>d+_.amount,0),debitTotal:p.reduce((d,_)=>d+Math.abs(_.amount),0)}}parseCSV(n){const o=n.split("\n").map(a=>a.trim()).filter(Boolean),e=o[0].split(",").map(a=>a.trim());return o.slice(1).map(a=>{const p=a.split(",").map(C=>C.trim()),s={};return e.forEach((C,y)=>s[C]=p[y]),{date:s.Date,description:s.Narration,amount:s["Withdrawal Amt."]?-parseFloat(s["Withdrawal Amt."]):parseFloat(s["Deposit Amt."]),balance:parseFloat(s["Closing Balance"])}})}static{this.\u0275fac=function(o){return new(o||c)}}static{this.\u0275prov=t.jDH({token:c,factory:c.\u0275fac,providedIn:"root"})}}return c})();const m=(c,P)=>({negative:c,positive:P});function l(c,P){if(1&c&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td",19),t.EFF(6),t.nI1(7,"number"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.nI1(10,"number"),t.k0s()()),2&c){const n=P.$implicit;t.R7$(2),t.JRh(n.date),t.R7$(2),t.JRh(n.description),t.R7$(),t.Y8G("ngClass",t.l_i(11,m,n.amount<0,n.amount>0)),t.R7$(),t.SpI(" ",t.i5U(7,5,n.amount,"1.2-2")," "),t.R7$(3),t.JRh(t.i5U(10,8,n.balance,"1.2-2"))}}function S(c,P){if(1&c&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.nI1(5,"currency"),t.k0s(),t.j41(6,"td"),t.EFF(7),t.nI1(8,"currency"),t.k0s()()),2&c){const n=P.$implicit,o=t.XpG(2);t.R7$(2),t.JRh(n),t.R7$(2),t.JRh(t.bMT(5,3,o.monthlySummary()[n].credit)),t.R7$(3),t.JRh(t.bMT(8,5,o.monthlySummary()[n].debit))}}function O(c,P){if(1&c&&(t.j41(0,"div",18)(1,"h3"),t.EFF(2,"Monthly Summary"),t.k0s(),t.j41(3,"div",15)(4,"table")(5,"thead")(6,"tr")(7,"th"),t.EFF(8,"Month"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Total Credit"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Total Debit"),t.k0s()()(),t.j41(13,"tbody"),t.Z7z(14,S,9,7,"tr",null,t.Vm6),t.k0s()()()()),2&c){const n=t.XpG();t.R7$(14),t.Dyx(n.getMonthlyKeys())}}let k=(()=>{class c{constructor(n){this.statementService=n,this.filters=(0,t.vPA)({fromDate:"",toDate:"",type:"",search:""}),this.itemsPerPage=10,this.currentPage=(0,t.vPA)(1),this.sortField=(0,t.vPA)("date"),this.sortOrder=(0,t.vPA)("asc"),this.filteredResult=(0,t.EWP)(()=>this.statementService.filterSortPaginate(this.filters(),this.sortField(),this.sortOrder(),this.currentPage(),this.itemsPerPage)),this.filteredData=(0,t.EWP)(()=>this.filteredResult().filteredData),this.paginatedData=(0,t.EWP)(()=>this.filteredResult().paginatedData),this.totalPages=(0,t.EWP)(()=>this.filteredResult().totalPages),this.monthlySummary=(0,t.EWP)(()=>this.statementService.groupByMonth(this.filteredData())),this.visiblePages=(0,t.EWP)(()=>{const o=this.totalPages(),e=this.currentPage(),i=Math.max(1,e-1),a=Math.min(o,i+2);return Array.from({length:a-i+1},(p,s)=>i+s)}),(0,t.QZP)(()=>{this.totalPages(),this.monthlySummary()})}ngOnInit(){}onFilterChange(n){this.filters.set(n),this.currentPage.set(1)}onSort(n){this.sortField()===n?this.sortOrder.set("asc"===this.sortOrder()?"desc":"asc"):(this.sortField.set(n),this.sortOrder.set("asc"))}onPageChange(n){this.currentPage.set(n)}downloadCSV(){this.statementService.exportCSV(this.filteredData(),"export-statements")}downloadJSON(){this.statementService.exportJSON(this.filteredData(),"export-statements")}downloadPDF(){this.statementService.exportPDF(this.filteredData(),"export-statements")}getSummary(){return this.statementService.getSummary(this.filteredData())}getMonthlyKeys(){return Object.keys(this.monthlySummary())}onCSVUpload(n){const o=n.target.files[0];if(!o)return;const e=new FileReader;e.onload=i=>{const p=this.statementService.parseCSV(i.target.result);this.statementService.setUploadedStatements(p),this.currentPage.set(1)},e.onerror=()=>{console.error("Error reading file.")},e.readAsText(o)}applyFilters(){this.onFilterChange({...this.filters()})}static{this.\u0275fac=function(o){return new(o||c)(t.rXU(r))}}static{this.\u0275cmp=t.VBU({type:c,selectors:[["app-statements"]],decls:77,vars:24,consts:[[1,"statement-container"],[1,"upload"],["for","csvUpload"],["type","file","id","csvUpload","accept",".csv",3,"change"],[1,"filters",3,"ngSubmit"],["type","date","name","fromDate",3,"ngModelChange","ngModel"],["type","date","name","toDate",3,"ngModelChange","ngModel"],["name","type",3,"ngModelChange","ngModel"],["value",""],["value","income"],["value","expense"],["type","text","name","search","placeholder","Description...",3,"ngModelChange","ngModel"],["type","submit"],[3,"exportCSV","exportJSON","exportPDF"],[1,"summary"],[1,"table-responsive"],[3,"click"],[3,"pageChange","currentPage","totalItems"],[1,"monthly-summary"],[3,"ngClass"]],template:function(o,e){1&o&&(t.j41(0,"div",0)(1,"div",1)(2,"label",2),t.EFF(3,"Upload CSV:"),t.k0s(),t.j41(4,"input",3),t.bIt("change",function(a){return e.onCSVUpload(a)}),t.k0s()(),t.j41(5,"form",4),t.bIt("ngSubmit",function(){return e.applyFilters()}),t.j41(6,"div")(7,"label"),t.EFF(8,"From Date:"),t.k0s(),t.j41(9,"input",5),t.mxI("ngModelChange",function(a){return t.DH7(e.filters().fromDate,a)||(e.filters().fromDate=a),a}),t.k0s()(),t.j41(10,"div")(11,"label"),t.EFF(12,"To Date:"),t.k0s(),t.j41(13,"input",6),t.mxI("ngModelChange",function(a){return t.DH7(e.filters().toDate,a)||(e.filters().toDate=a),a}),t.k0s()(),t.j41(14,"div")(15,"label"),t.EFF(16,"Type:"),t.k0s(),t.j41(17,"select",7),t.mxI("ngModelChange",function(a){return t.DH7(e.filters().type,a)||(e.filters().type=a),a}),t.j41(18,"option",8),t.EFF(19,"All"),t.k0s(),t.j41(20,"option",9),t.EFF(21,"Income"),t.k0s(),t.j41(22,"option",10),t.EFF(23,"Expense"),t.k0s()()(),t.j41(24,"div")(25,"label"),t.EFF(26,"Search:"),t.k0s(),t.j41(27,"input",11),t.mxI("ngModelChange",function(a){return t.DH7(e.filters().search,a)||(e.filters().search=a),a}),t.k0s()(),t.j41(28,"button",12),t.EFF(29,"Apply"),t.k0s()(),t.j41(30,"app-export-buttons",13),t.bIt("exportCSV",function(){return e.downloadCSV()})("exportJSON",function(){return e.downloadJSON()})("exportPDF",function(){return e.downloadPDF()}),t.k0s(),t.j41(31,"div",14)(32,"div")(33,"strong"),t.EFF(34,"Opening Balance:"),t.k0s(),t.EFF(35),t.nI1(36,"currency"),t.k0s(),t.j41(37,"div")(38,"strong"),t.EFF(39,"Closing Balance:"),t.k0s(),t.EFF(40),t.nI1(41,"currency"),t.k0s(),t.j41(42,"div")(43,"strong"),t.EFF(44,"Credit Count:"),t.k0s(),t.EFF(45),t.k0s(),t.j41(46,"div")(47,"strong"),t.EFF(48,"Debit Count:"),t.k0s(),t.EFF(49),t.k0s(),t.j41(50,"div")(51,"strong"),t.EFF(52,"Total Credit:"),t.k0s(),t.EFF(53),t.nI1(54,"currency"),t.k0s(),t.j41(55,"div")(56,"strong"),t.EFF(57,"Total Debit:"),t.k0s(),t.EFF(58),t.nI1(59,"currency"),t.k0s()(),t.j41(60,"div",15)(61,"table")(62,"thead")(63,"tr")(64,"th",16),t.bIt("click",function(){return e.onSort("date")}),t.EFF(65),t.k0s(),t.j41(66,"th"),t.EFF(67,"Description"),t.k0s(),t.j41(68,"th",16),t.bIt("click",function(){return e.onSort("amount")}),t.EFF(69),t.k0s(),t.j41(70,"th",16),t.bIt("click",function(){return e.onSort("balance")}),t.EFF(71),t.k0s()()(),t.j41(72,"tbody"),t.Z7z(73,l,11,14,"tr",null,t.Vm6),t.k0s()()(),t.j41(75,"app-pagination",17),t.bIt("pageChange",function(a){return e.onPageChange(a)}),t.k0s(),t.DNE(76,O,16,0,"div",18),t.k0s()),2&o&&(t.R7$(9),t.R50("ngModel",e.filters().fromDate),t.R7$(4),t.R50("ngModel",e.filters().toDate),t.R7$(4),t.R50("ngModel",e.filters().type),t.R7$(10),t.R50("ngModel",e.filters().search),t.R7$(8),t.SpI(" ",t.bMT(36,16,e.getSummary().openingBalance)," "),t.R7$(5),t.SpI(" ",t.bMT(41,18,e.getSummary().closingBalance)," "),t.R7$(5),t.SpI(" ",e.getSummary().creditCount,""),t.R7$(4),t.SpI(" ",e.getSummary().debitCount,""),t.R7$(4),t.SpI(" ",t.bMT(54,20,e.getSummary().creditTotal)," "),t.R7$(5),t.SpI(" ",t.bMT(59,22,e.getSummary().debitTotal)," "),t.R7$(7),t.SpI(" \u{1f4c5} Date ","date"===e.sortField()?"asc"===e.sortOrder()?"\u2191":"\u2193":""," "),t.R7$(4),t.SpI(" \u{1f4b0} Amount ","amount"===e.sortField()?"asc"===e.sortOrder()?"\u2191":"\u2193":""," "),t.R7$(2),t.SpI(" \u{1f4bc} Balance ","balance"===e.sortField()?"asc"===e.sortOrder()?"\u2191":"\u2193":""," "),t.R7$(2),t.Dyx(e.paginatedData()),t.R7$(2),t.Y8G("currentPage",e.currentPage())("totalItems",e.filteredData().length),t.R7$(),t.vxM(e.getMonthlyKeys().length>0?76:-1))},dependencies:[b.NgClass,h.YN,h.qT,h.xH,h.y7,h.me,h.wz,h.BC,h.cb,h.vS,h.cV,b.DecimalPipe,b.CurrencyPipe,D.e,M.B],styles:['[_nghost-%COMP%]{--primary-color: #007bff;--secondary-color: #f8f9fa;--text-color: #212529;--positive-color: #28a745;--negative-color: #dc3545;--border-color: #dee2e6;--hover-bg: #e9ecef;--font-family: "Segoe UI", sans-serif;font-family:var(--font-family);color:var(--text-color)}.statement-container[_ngcontent-%COMP%]{padding:1.5rem;max-width:100%;background-color:#fff}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem;align-items:center;align-items:flex-end}.filters[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:160px}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem;font-size:1rem;border:1px solid var(--border-color);border-radius:4px;transition:border-color .2s}.filters[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .filters[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:var(--primary-color);outline:none}button[_ngcontent-%COMP%]{padding:.5rem 1rem;font-size:1rem;border:none;background-color:var(--primary-color);color:#fff;cursor:pointer;border-radius:4px;transition:background-color .2s}button[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto;box-shadow:0 2px 8px #0000000d;border-radius:6px}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:1rem}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid var(--border-color);white-space:nowrap}th[_ngcontent-%COMP%]{cursor:pointer;background-color:var(--secondary-color);-webkit-user-select:none;user-select:none}th[_ngcontent-%COMP%]:hover{background-color:var(--hover-bg)}.positive[_ngcontent-%COMP%]{color:var(--positive-color)}.negative[_ngcontent-%COMP%]{color:var(--negative-color)}.summary[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2rem;margin-bottom:1rem;font-size:1rem}.summary[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{flex:1;min-width:200px;background-color:#fdfdfd;padding:1rem;border:1px solid var(--border-color);border-radius:6px}.monthly-summary[_ngcontent-%COMP%]{margin-top:2rem}.monthly-summary[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;color:var(--primary-color)}.upload[_ngcontent-%COMP%]{margin:1rem 0}.upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{margin-top:.25rem}@media (max-width: 768px){.filters[_ngcontent-%COMP%]{flex-direction:column}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:.9rem}.summary[_ngcontent-%COMP%]{flex-direction:column}}']})}}return c})()}}]);